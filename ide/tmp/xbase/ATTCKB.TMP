.* ----------------------------------------------------------------------------
.* TEMPLATE     : ATTCKB.tmp
.* RELEASE      : 4.0
.* VERSION      : d
.* DESCRIZIONE  : Aggiunge control CHECK BOX ad oggetto.
.* ----------------------------------------------------------------------------
.M->cTcnd  := ["]+tItmActive()+["]
.if !empty(toItem("ckbcondition")) .AND. toItem("ckbcondition")!=".T."
   .M->cTcnd := cTcnd + ".AND.(" + toItem("ckbcondition")+")"
.endif
.M->cTvar  := if( Empty( toItem("ckbdataorigin") ) ,"cDmmVar" ,toItem("ckbdataorigin") )
.M->cTval1 := if( Empty( toItem("ckbdatavalue1" ) ) ,"NIL" ,toItem("ckbdatavalue1") )
.M->cTval2 := if( Empty( toItem("ckbdatavalue2" ) ) ,"NIL" ,toItem("ckbdatavalue2") )
.M->cTc    := ["]+tItmCol("promptcolor")    +[","]+tItmCol("hotkeycolor")+[","]+;
                  tItmCol("prompthilitecol")+[","]+tItmCol("iconcolor")  +["]
.M->cXTc := ""
.if empty(toItem("xbpromptcolor"))
   .M->cXTc := "{"+cTc+"}"
.else
   .if empty(toItem("xbpromptcolor"))
      .M->cXTc := ["]+tItmCol("promptcolor") +[",NIL,NIL,NIL]
   .else
      .M->cXTc := ["]+toItem("xbpromptcolor") +[",NIL,NIL,NIL]
   .endif
   .M->cXTc := 'DFXPPCLRSELECT({'+cXTc+'},{'+cTc+'})'
.endif
.M->cTgap := toItem("promptgap")
.M->cFont := toItem("fontname")
.if ! empty(cFont) .and. at("(", cFont) == 0
    .M->cFont := ["]+cFont+["]
.endif
ATTACH "ÛcIdC+'" TO oWin:W_CONTROL GET AS CHECKBOX '+cTvar+'  PROMPT '+tExpCast(trim(oo_itm->ITMSAY))Û ð ; // ATTCKB.TMP
                 AT ÛnTr1+[,]+nTc1Û   ð ; // Coordinate
.if type("OS()")=="C"    
.* Visual dBsee
                 SIZE       {ÛnTc2Û,ÛnTr2Û} ð ; // Dimensioni Campo get
                 COORDINATE  W_COORDINATE_PIXEL  ð ; // Coordinate in Pixel
.endif
                 VALUEON  ÛcTval1Û    ð ; // Valore in ON
                 VALUEOFF ÛcTval2Û    ð ; // Valore in OFF
                 GAP      ÛcTgapÛ     ð ; // Spazio ICONA / PROMPT
.if !(cTpag=="1")
                 PAGE     ÛcTpagÛ     ð ; // Pagina
.endif
                 COLOR    ÛcXTcÛ     ð ; // Array dei colori
.if !Empty(cTrefId)
                 REFRESHID "ÛcTrefIdÛ" ð ; // Appartiene ai gruppi di refresh
.endif
.if !Empty(cTrefGr)
                 REFRESHGRP "ÛcTrefGrÛ" ð ; // Esegue il gruppo di refresh
.endif
.if !Empty(toItem("whenclicked"))
                 WHENCLICKED {||ÛtoItem("whenclicked")Û}   ð ; // Funzione chiamata alla selezione control
.endif
.if !(cTdis=="{||.T.}")
                 DISPLAYIF ÛcTdisÛ    ð ; // Display condizionale
.endif
.if !Empty(cFont)
                 FONT       ÛcFontÛ ð ; // Font Name (XBASE)
.endif
                 ACTIVE   {||cState $ ÛcTcndÛ } ð ; // Stato di attivazione
                 VARNAME "ÛcTvarÛ" ð ; //
                 MESSAGE ÛtExpCast(cTmsg)Û ð   // Messaggio utente
